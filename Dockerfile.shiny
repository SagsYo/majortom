

FROM continuumio/miniconda:4.7.12

# RUN mkdir /mylibs
# ENV R_LIBS /mylibs
ADD shiny/dependencies.R /dependencies.R
ADD shiny/majortom.yml /
RUN conda env create -f /majortom.yml && conda clean -a

#RUN conda init bash
ENV PATH /opt/conda/envs/majortom/bin:$PATH

RUN Rscript /dependencies.R

RUN apt install -y libcairo2

ADD shiny /shiny
ENV SATCAT_CSV /shiny/majortom/satcat_meta_active.csv

WORKDIR /shiny/majortom
CMD Rscript app.R
